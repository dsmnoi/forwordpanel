(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58c96f53"],{"0732":function(t,e,a){"use strict";var r=a("d3f9"),s=a.n(r);s.a},1148:function(t,e,a){"use strict";var r=a("a691"),s=a("1d80");t.exports="".repeat||function(t){var e=String(s(this)),a="",o=r(t);if(o<0||o==1/0)throw RangeError("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(a+=e);return a}},"31da":function(t,e,a){},"36fb":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"top-pannel"},[a("span",{staticClass:"top-span",class:{mobile:t.isMobile}},[a("span",[t._v("当前账户:")]),t._v(" "),a("span",{staticClass:"top-text"},[a("el-select",{attrs:{size:"mini",filterable:""},on:{change:t.handleSelectUser},model:{value:t.searchForm.userId,callback:function(e){t.$set(t.searchForm,"userId",e)},expression:"searchForm.userId"}},t._l(t.userList,(function(t,e){return a("el-option",{key:t+e,attrs:{label:t.username,value:t.id}})})),1)],1)]),a("span",{staticClass:"top-span",class:{mobile:t.isMobile}},[a("span",{staticClass:"top-text"},[a("el-select",{attrs:{size:"mini",filterable:""},on:{change:t.handleSelectServer},model:{value:t.searchForm.serverId,callback:function(e){t.$set(t.searchForm,"serverId",e)},expression:"searchForm.serverId"}},t._l(t.serverList,(function(t,e){return a("el-option",{key:e,attrs:{label:t.serverName,value:t.id}})})),1)],1)]),a("span",{staticClass:"top-span",class:{mobile:t.isMobile}},[a("span",[t._v("账户到期时间:")]),t._v(" "),a("span",{staticClass:"top-text"},[t._v(t._s(t._f("parseTime")(t.userDetail.expireTime,"{y}-{m}-{d}")))])]),a("span",{staticClass:"top-span",class:{mobile:t.isMobile}},[a("span",[t._v("账户流量:")]),t._v(" "),a("span",{staticClass:"top-text"},[t._v(t._s(t.getFlow(t.userDetail.dataUsage))+"/"+t._s(t.userDetail.dataLimit<=0?"不限制":t.userDetail.dataLimit+"G"))])]),a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.refreshData()}}},[t._v("刷新")]),t.checkUserDisabled()?a("el-button",{staticStyle:{color:"red"},attrs:{type:"text",size:"mini"},on:{click:function(e){return t.showContactInfo()}}},[t._v("账号被禁用,点击联系管理员")]):t._e()],1),t._m(0),a("div",{staticClass:"item-container"},t._l(t.tableData,(function(e,r){return a("div",{key:e+r,staticClass:"item-box"},[a("div",{staticClass:"server-status"},[e.disabled?a("span",{staticStyle:{color:"#909399"}},[a("i",{staticClass:"el-icon-video-pause"}),t._v(" 已停止")]):t._e(),e.disabled?t._e():a("span",{staticStyle:{color:"#67C23A"}},[a("i",{staticClass:"el-icon-video-play"}),t._v(" 已启动")])]),a("div",{staticClass:"box-col",staticStyle:{"font-size":"18px","font-weight":"bold"}},[t._v(t._s(e.serverName))]),a("div",{staticClass:"box-col"},[a("label",[t._v("中转地址:")]),t._v(t._s(e.serverHost))]),a("div",{staticClass:"box-col"},[a("label",[t._v("中转端口:")]),a("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(e.internetPort))])]),a("div",{staticClass:"box-col"},[a("label",[t._v("远程地址:")]),a("span",{staticStyle:{"font-weight":"bold"}},[t._v(t._s(e.remoteHost?e.remoteHost:"未设置"))])]),a("div",{staticClass:"box-col"},[a("label",[t._v("远程端口:")]),t._v(t._s(e.remotePort?e.remotePort:"未设置"))]),a("div",{staticClass:"box-col"},[a("label",[t._v("使用流量:")]),t._v(t._s(t.getFlow(e.dataUsage)))]),a("div",{staticClass:"box-trl"},[a("el-button",{attrs:{type:"text",icon:"el-icon-goblet-square-full",size:"mini",title:"启用中转"},on:{click:function(a){return t.showDataDetail(e)}}},[t._v("流量详情")]),a("el-button",{attrs:{type:"text",icon:"el-icon-goblet-square-full",size:"mini",title:"启用中转"},on:{click:function(a){return t.stopForward(e)}}},[t._v("停止中转")]),e.disabled?a("el-button",{attrs:{type:"text",icon:"el-icon-video-play",size:"mini",title:"启用中转"},on:{click:function(a){return t.showStartDialog(e)}}},[t._v("启动中转")]):t._e(),e.disabled?t._e():a("el-button",{attrs:{icon:"el-icon-video-pause",loading:!!e.btnLoading,type:"text",size:"mini",title:"停止中转"},on:{click:function(a){return t.stopForward(e)}}},[t._v("停止中转")])],1)])})),0),a("xd-pager",{attrs:{background:"",fixed:"","page-sizes":[8,16,32],"page-size":t.searchForm.pageSize,"current-page":t.searchForm.pageNum,layout:"total, sizes, prev, pager, next, jumper",total:t.dataTotal},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),a("el-dialog",{attrs:{title:"启动转发","close-on-click-modal":!1,"close-on-press-escape":!1,visible:t.startDialog,width:"30%"},on:{close:function(e){t.loading=!1},"update:visible":function(e){t.startDialog=e}}},[a("el-form",{ref:"addForm",attrs:{model:t.addForm,rules:t.addFormRules,"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"域名(或IP)",prop:"remoteHost"}},[a("el-input",{attrs:{size:"mini"},model:{value:t.addForm.remoteHost,callback:function(e){t.$set(t.addForm,"remoteHost",e)},expression:"addForm.remoteHost"}})],1),a("el-form-item",{attrs:{label:"端口",prop:"remotePort",rules:[{required:!0,message:"端口不能为空"},{type:"number",message:"端口必须为数字值"}]}},[a("el-input",{attrs:{size:"mini"},model:{value:t.addForm.remotePort,callback:function(e){t.$set(t.addForm,"remotePort",t._n(e))},expression:"addForm.remotePort"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.startDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{loading:t.loading,type:"primary"},on:{click:function(e){return t.confirmStart(t.row)}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"联系方式",visible:t.contactInfoDialog,width:"30%"},on:{"update:visible":function(e){t.contactInfoDialog=e}}},[a("el-form",{attrs:{"label-width":"120px",size:"small"}},[a("el-form-item",{attrs:{label:"TG:"}},[a("a",{staticStyle:{color:"dodgerblue"},attrs:{href:t.contactInfo.telegram}},[t._v(t._s(t.contactInfo.telegram))])]),a("el-form-item",{attrs:{label:"QQ:"}},[a("span",[t._v(t._s(t.contactInfo.qq))])]),a("el-form-item",{attrs:{label:"邮箱:"}},[a("span",[t._v(t._s(t.contactInfo.email))])])],1)],1),a("el-drawer",{attrs:{title:"查看端口","with-header":!1,visible:t.forwardFlowDialog,direction:"rtl",size:t.drawerPercent},on:{"update:visible":function(e){t.forwardFlowDialog=e}}},[a("div",{staticClass:"drawer-body"},[a("span",[t._v("流量详情")]),a("div",{staticClass:"item-container"},[0===t.forwardFlowList.length?a("div",{staticClass:"item-box",staticStyle:{"box-shadow":"none"}},[a("div",{staticClass:"box-col"},[t._v("暂无数据")])]):t._l(t.forwardFlowList,(function(e,r){return a("div",{key:r,staticClass:"item-box"},[a("div",{staticClass:"box-col"},[a("label",[t._v("服务器名称")]),t._v(t._s(e.serverName))]),a("div",{staticClass:"box-col"},[a("label",[t._v("服务器端口")]),t._v(t._s(e.localPort))]),a("div",{staticClass:"box-col"},[a("label",[t._v("被中转地址")]),t._v(t._s(e.remoteHost))]),a("div",{staticClass:"box-col"},[a("label",[t._v("被中转端口")]),t._v(t._s(e.remotePort))]),a("div",{staticClass:"box-col"},[a("label",[t._v("已用流量")]),t._v(t._s(t.getFlow(e.dataUsage)))])])}))],2)])])],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"font-size":"12px",color:"#606266",margin:"5px 0 10px 0"}},[a("i",{staticClass:"el-icon-warning",staticStyle:{"margin-right":"3px"}}),t._v("转发设置后如果没有生效, 请停用重新启用")])}],o=(a("a9e3"),a("b680"),a("b775"));function i(t){return Object(o["a"])({url:"/forward/getPage",method:"post",data:t})}function n(t){return Object(o["a"])({url:"/forward/start",method:"post",data:t})}function l(t){return Object(o["a"])({url:"/forward/stop",method:"post",data:t})}var c=a("c24f"),d=a("5f87"),u=a("8593"),f=a("aa22"),m={data:function(){return{tableData:[],dataTotal:null,loading:!1,searchForm:{userId:null,serverId:null,pageSize:8,pageNum:1},userTypeList:[{name:"管理员",value:0},{name:"普通用户",value:1}],addForm:{id:null,username:null,addType:"add",password:null,remotePort:null,remoteHost:null},addFormRules:{remoteHost:[{required:!0,trigger:"blur",message:"必需项"}]},startDialog:!1,userList:[],serverList:[],userDetail:{dataUsage:0,dataLimit:0},forwardFlowDialog:!1,forwardFlowList:[],contactInfoDialog:!1,contactInfo:{}}},mounted:function(){this.getData()},methods:{getData:function(){var t=this;Object(c["n"])({}).then((function(e){t.userList=e.data,t.searchForm.userId=Number(Object(d["a"])()),t.getServerList(),t.getUserDetail()}))},getServerList:function(){var t=this;Object(f["c"])(this.searchForm).then((function(e){t.serverList=e.data,t.serverList.length&&(t.searchForm.serverId=t.serverList[0].id,t.addForm.serverId=t.serverList[0].id,t.getForwardList())}))},getForwardList:function(){var t=this;i(this.searchForm).then((function(e){t.tableData=e.data.list,t.dataTotal=e.data.total}))},checkUserDisabled:function(){var t=Object(c["j"])();return!(!t||!t.disabled)},confirmStart:function(){var t=this;this.$refs["addForm"].validate((function(e){e&&(t.loading=!0,console.log(t.addForm),n(t.addForm).then((function(e){t.loading=!1,t.$notify({message:"启动成功",type:"success"}),t.startDialog=!1,t.refreshData()})))}))},handleSelectUser:function(t){var e=this;this.searchForm.userId=t,this.addForm.userId=t,this.searchForm.serverId=null,this.getServerList(),this.getForwardList(),Object(c["m"])({userId:this.searchForm.userId}).then((function(t){e.userDetail=t.data}))},handleSelectServer:function(t){this.searchForm.serverId=t,this.getForwardList()},refreshData:function(){var t=this;i(this.searchForm).then((function(e){t.tableData=e.data.list,t.dataTotal=e.data.total})),Object(c["m"])({userId:this.searchForm.userId}).then((function(e){t.userDetail=e.data})),this.$notify({message:"刷新完成",type:"success"})},showDataDetail:function(t){var e=this;console.log("flow",t),this.forwardFlowDialog=!0,Object(c["l"])({forwardId:t.id}).then((function(t){e.forwardFlowList=t.data}))},handleServerChange:function(t){var e=this;this.searchForm.serverId=t,i(this.searchForm).then((function(t){e.tableData=t.data.list,e.dataTotal=t.data.total}))},handleSizeChange:function(t){this.searchForm.pageSize=t,this.getData()},handleCurrentChange:function(t){this.searchForm.pageNum=t,this.getData()},showStartDialog:function(t){this.startDialog=!0,this.addForm.serverId=t.serverId,this.addForm.portId=t.portId,this.addForm.id=t.id,this.addForm.remotePort=t.remotePort,this.addForm.remoteHost=t.remoteHost},stopForward:function(t){var e=this;console.log(">>>stop",t),this.addForm.serverId=t.serverId,this.addForm.portId=t.portId,this.addForm.id=t.id,this.$set(t,"btnLoading",!0),l(this.addForm).then((function(a){e.$set(t,"btnLoading",!1),e.$notify({message:"停止完成",type:"success"}),e.refreshData()}))},showContactInfo:function(){var t=this;this.contactInfoDialog=!0,Object(u["b"])({}).then((function(e){t.contactInfo=e.data}))},getFlow:function(t){var e="";if(t/1024<1024)e=(Math.round(t/1024)>0?Math.round(t/1024):0)+"KB";else if(t/1024>=1024&&t/1024/1024<1024)e=(Math.round(t/1024/1024)>0?Math.round(t/1024/1024):0)+"MB";else if(t/1024/1024>=1024){var a=t/1024/1024/1024;e=a.toFixed(3)+"GB"}else e="0KB";return e}}},h=m,v=(a("0732"),a("d6c3"),a("2877")),p=Object(v["a"])(h,r,s,!1,null,"72a6dba4",null);e["default"]=p.exports},"408a":function(t,e,a){var r=a("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=r(t))throw TypeError("Incorrect invocation");return+t}},"5a30":function(t,e){t.exports="object"==typeof self?self.FormData:window.FormData},8593:function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"d",(function(){return l})),a.d(e,"b",(function(){return c}));var r=a("b775"),s=a("5a30"),o=a.n(s);function i(t){return Object(r["a"])({url:"/system/exportData",method:"get",params:t})}function n(t){var e=new o.a;return e.append("file",t.file),Object(r["a"])({method:"post",url:"/system/importData",headers:{"Content-Type":"multipart/form-data"},data:e})}function l(t){return Object(r["a"])({url:"/sysConfig/save",method:"post",data:t})}function c(t){return Object(r["a"])({url:"/sysConfig/getSysConfig",method:"get",params:t})}},aa22:function(t,e,a){"use strict";a.d(e,"e",(function(){return s})),a.d(e,"d",(function(){return o})),a.d(e,"c",(function(){return i})),a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return l})),a.d(e,"f",(function(){return c}));var r=a("b775");function s(t){return Object(r["a"])({url:"/server/getPage",method:"post",data:t})}function o(t){return Object(r["a"])({url:"/server/getList",method:"get",data:t})}function i(t){return Object(r["a"])({url:"/server/getForwardServerList",method:"get",params:t})}function n(t){return Object(r["a"])({url:"/server/delete",method:"get",params:t})}function l(t){return Object(r["a"])({url:"/server/check",method:"get",params:t})}function c(t){return Object(r["a"])({url:"/server/save",method:"post",data:t})}},b680:function(t,e,a){"use strict";var r=a("23e7"),s=a("a691"),o=a("408a"),i=a("1148"),n=a("d039"),l=1..toFixed,c=Math.floor,d=function(t,e,a){return 0===e?a:e%2===1?d(t,e-1,a*t):d(t*t,e/2,a)},u=function(t){var e=0,a=t;while(a>=4096)e+=12,a/=4096;while(a>=2)e+=1,a/=2;return e},f=l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n((function(){l.call({})}));r({target:"Number",proto:!0,forced:f},{toFixed:function(t){var e,a,r,n,l=o(this),f=s(t),m=[0,0,0,0,0,0],h="",v="0",p=function(t,e){var a=-1,r=e;while(++a<6)r+=t*m[a],m[a]=r%1e7,r=c(r/1e7)},b=function(t){var e=6,a=0;while(--e>=0)a+=m[e],m[e]=c(a/t),a=a%t*1e7},g=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==m[t]){var a=String(m[t]);e=""===e?a:e+i.call("0",7-a.length)+a}return e};if(f<0||f>20)throw RangeError("Incorrect fraction digits");if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(h="-",l=-l),l>1e-21)if(e=u(l*d(2,69,1))-69,a=e<0?l*d(2,-e,1):l/d(2,e,1),a*=4503599627370496,e=52-e,e>0){p(0,a),r=f;while(r>=7)p(1e7,0),r-=7;p(d(10,r,1),0),r=e-1;while(r>=23)b(1<<23),r-=23;b(1<<r),p(1,1),b(2),v=g()}else p(0,a),p(1<<-e,0),v=g()+i.call("0",f);return f>0?(n=v.length,v=h+(n<=f?"0."+i.call("0",f-n)+v:v.slice(0,n-f)+"."+v.slice(n-f))):v=h+v,v}})},d3f9:function(t,e,a){},d6c3:function(t,e,a){"use strict";var r=a("31da"),s=a.n(r);s.a}}]);